<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">

<head>
<meta charset="UTF-8">
<meta name="description" content="Market, Auction">
<meta name="keywords" content="Auction">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>커뮤니티</title>
</head>
<body>
	<div layout:fragment="content">
		<!-- Breadcrumb Section Begin -->
		<section class="breadcrumb-option">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<div class="breadcrumb__text">
							<h4>유귀농 커뮤니티</h4>
							<div class="breadcrumb__links">
								<span>전국 각 도의 유귀농인들과 함께 소통해보아요 !</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- Breadcrumb Section End -->

		<section class="shop spad">
			<div class="container">
				<div class="row">
					<div class="col-lg-3">
						<div class="shop__sidebar">
							<div class="shop__sidebar__accordion">
								<div class="accordion" id="accordionExample">
									<div class="card">
										<div class="card-heading">
											<a data-toggle="collapse" data-target="#collapseOne">유귀농
												게시판</a>
										</div>
										<div id="collapseOne" class="collapse show"
											data-parent="#accordionExample">
											<div class="card-body">
												<div class="shop__sidebar__categories">
													<ul class="nice-scroll">
														<li><a href="noticeList">공지사항</a></li>
														<li><a href="communityList" style="color: black;">커뮤니티</a></li>
														<li><b><a href="eventList">이벤트</a></b></li>
													</ul>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row col-lg-9">
						<div class="col-lg-12" style="margin-left: 0;">
							<h4 class="center">공지사항</h4>
							<div class="shopping__cart__table" style="margin-bottom: 0px;">
								<table id="myTable" class="center">
									<thead>
										<hr>
										<tr class="center">
											<th class="">순번</th>
											<th class=""></th>
											<th class="">제목</th>
											<th class="">작성자</th>
											<th class="">작성일</th>
											<th class="">조회수</th>
											<th class="">추천수</th>
										</tr>
									</thead>
									<tbody id="cmmnList">
									</tbody>
								</table>
								<hr>
								<button type="button">등록</button>
							</div>
						</div>
						<div class="row" id="pageDiv"></div>
					</div>
				</div>
			</div>
		</section>
		
		<!-- pageDiv Clone용-->
		<div class="product__pagination" style="display: none;" id="pageItem">
			<a class="myInline" id="prevPage">◁</a>
			<div id="pageNumDiv" class="myInline">
				<a id="pageNum">a</a>
			</div>
			<a class="myInline" id="nextPage">▷</a>
		</div>

		<script th:inline="javascript">
			$(function(){
				boardData('i3', 1);
			})
			
			// 이벤트 리스트 데이터 가져오기
			function boardData(postCtg, pageNum, dst1){
				$.ajax({
					url: "boardList",
					method: "GET",
					data: {
                        postCtg,
						pageNum,
						dst1
					},
					success(data){
						console.log(data);
						console.log(dst1);
						printList(data, dst1);
						
						}
					},
					error(reject){
						console.log(reject);
					}
				})
			}
				
			// 리스트 출력
			function printList(data, dst1){
				
				$('#pageDiv').children().remove();
				
				let cmmnData = data.boardList;
				let pageData = data.pageInfo;
				
				$(cmmnData).each((idx, item) => {
					printItem(item);
				})
				
				printPage(pageData, dst1);
			}
			
			// 커뮤니티 게시글 생성 및 추가 함수
            function printItem(item){
				
				let tr = $('<tr>');
				
				tr.append($('<td/>'))
            	
            	// 데이터 넣기
            	let imageUrl = item.img;
            	$(clone).find('.set-bg').css('background-image', 'url('+imageUrl+')');
            	$(clone).find('.set-bg').on('click', function(){
            		location.href = `eventInfo?postCtg=i4&boardNo=${item.boardNo}`
            	})
            	$(clone).find('.eDst2').text(item.dst2);
            	$(clone).find('.eTitle').text(item.title);
            	
            	$('#eventList').append(clone);
            }
		</script>

	</div>
</body>
</html>